<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Loading... | NEET Study Hub</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
<style>
:root {
    --primary-color: #2d3436;
    --accent-color: #0984e3;
    --text-color: #2d3436;
    --light-text: #636e72;
    --background: #f9fafb;
    --card-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
    --hover-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
    --transition: all 0.3s ease;
}

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    line-height: 1.6;
    color: var(--text-color);
    background: var(--background);
}

/* Post container */
.post-container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 2rem;
}

/* Breadcrumb */
.breadcrumb {
    margin-bottom: 2rem;
}

.breadcrumb ul {
    list-style: none;
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
}

.breadcrumb li {
    display: flex;
    align-items: center;
    font-size: 0.9rem;
    color: var(--light-text);
}

.breadcrumb li:not(:last-child)::after {
    content: "/";
    margin-left: 0.5rem;
    color: #cbd5e0;
}

.breadcrumb a {
    color: var(--accent-color);
    text-decoration: none;
    transition: var(--transition);
}

.breadcrumb a:hover {
    color: var(--primary-color);
}

/* Post Header */
.post-header {
    margin-bottom: 3rem;
}

.post-title {
    font-size: 2.5rem;
    font-weight: 800;
    line-height: 1.2;
    margin-bottom: 1.5rem;
    color: var(--primary-color);
}

.post-meta {
    display: flex;
    align-items: center;
    gap: 1rem;
}

.author {
    display: flex;
    align-items: center;
    gap: 1rem;
}

.author-avatar {
    width: 48px;
    height: 48px;
    border-radius: 50%;
    object-fit: cover;
    border: 2px solid var(--accent-color);
}

.author-info {
    display: flex;
    flex-direction: column;
}

.author-name {
    font-weight: 600;
    color: var(--primary-color);
}

.post-date {
    color: var(--light-text);
    font-size: 0.9rem;
}

/* Post Content */
.post-content {
    background: white;
    padding: 3rem;
    border-radius: 1rem;
    box-shadow: var(--card-shadow);
    margin-bottom: 2rem;
}

.post-content img {
    max-width: 100%;
    height: auto;
    border-radius: 0.5rem;
    margin: 1.5rem 0;
}

.post-content h2 {
    font-size: 1.8rem;
    margin: 2rem 0 1rem;
    color: var(--primary-color);
}

.post-content h3 {
    font-size: 1.4rem;
    margin: 1.5rem 0 1rem;
    color: var(--primary-color);
}

.post-content p {
    margin-bottom: 1.5rem;
}

.post-content blockquote {
    border-left: 4px solid var(--accent-color);
    padding: 1rem 1.5rem;
    margin: 2rem 0;
    background: rgba(9, 132, 227, 0.05);
    border-radius: 0 0.5rem 0.5rem 0;
}

/* Related Posts */
.sidebar-wrapper {
    position: relative;
}

.related-posts {
    background: transparent;
    padding: 1rem 0;
    position: sticky;
    top: 2rem;
    
    overflow-y: auto;
    scrollbar-width: thin;
    scrollbar-color: var(--accent-color) transparent;
}

.related-posts::-webkit-scrollbar {
    width: 4px;
}

.related-posts::-webkit-scrollbar-track {
    background: transparent;
}

.related-posts::-webkit-scrollbar-thumb {
    background-color: var(--accent-color);
    border-radius: 2px;
}

.related-posts h2 {
    font-size: 1.5rem;
    margin-bottom: 1.5rem;
    color: var(--primary-color);
}

.related-posts-grid {
    display: grid;
    gap: 1.5rem;
}

.related-post {
    background: white;
    border-radius: 1rem;
    overflow: hidden;
    box-shadow: var(--card-shadow);
    transition: var(--transition);
}

.related-post:hover {
    transform: translateY(-2px);
    box-shadow: var(--hover-shadow);
}

.related-post img {
    width: 100%;
    height: 180px;
    object-fit: cover;
}

.related-post h3 {
    padding: 1rem 1rem 0.5rem;
}

.related-post p {
    padding: 0 1rem 1rem;
    color: var(--light-text);
}

/* Loading states */
.loading {
    padding: 2rem;
    text-align: center;
    color: var(--light-text);
}

.loading::after {
    content: '';
    display: inline-block;
    width: 1rem;
    height: 1rem;
    border: 2px solid var(--accent-color);
    border-radius: 50%;
    border-top-color: transparent;
    animation: spin 1s linear infinite;
    margin-left: 0.5rem;
}

@keyframes spin {
    to { transform: rotate(360deg); }
}

/* Error message */
.error-message {
    text-align: center;
    padding: 2rem;
}

.error-message h2 {
    color: var(--primary-color);
    margin-bottom: 1rem;
}

.error-message a {
    display: inline-block;
    margin-top: 1rem;
    padding: 0.5rem 1rem;
    background: var(--accent-color);
    color: white;
    text-decoration: none;
    border-radius: 0.25rem;
    transition: var(--transition);
}

.error-message a:hover {
    background: var(--primary-color);
}

/* Desktop Layout */
@media (min-width: 1070px) {
    .post-container {
        display: grid;
        grid-template-columns: 1fr 350px;
        gap: 3rem;
    }
}

/* Medium screens */
@media (min-width: 769px) and (max-width: 1069px) {
    .post-container {
        display: grid;
        grid-template-columns: 1fr 250px;
        gap: 1.5rem;
    }

    .post-content {
        padding: 2rem;
    }

    .related-post img {
        height: 140px;
    }
}

/* Mobile */
@media (max-width: 768px) {
    .post-container {
        display: block;
        padding: 1rem;
    }
    
    .post-title {
        font-size: 2rem;
    }
    
    .related-posts-grid {
        grid-template-columns: repeat(2, 1fr);
        gap: 1rem;
    }
}

@media (max-width: 480px) {
    .related-posts-grid {
        grid-template-columns: 1fr;
    }
    
    .related-post img {
        height: 160px;
    }
}
  
</style>
</head>
<body>
    <main class="post-container">
        <div class="main-content">
            <nav class="breadcrumb">
                <ul>
                    <li><a href="/"><i class="fas fa-home"></i> Home</a></li>
                    <li><a href="/blog.html">All Posts</a></li>
                    <li>Loading...</li>
                </ul>
            </nav>

            <header class="post-header">
                <h1 class="post-title">Loading...</h1>
                <div class="post-meta">
                    <div class="author">
                        <img src="author-avatar.jpg" alt="NEET Study Hub" class="author-avatar">
                        <div class="author-info">
                            <span class="author-name">NEET Study Hub</span>
                            <span class="post-date"><i class="far fa-calendar-alt"></i> Loading...</span>
                        </div>
                    </div>
                </div>
            </header>

            <article class="post">
                <div class="post-content">
                    <div class="loading">Loading post content...</div>
                </div>
            </article>
        </div>

        <div class="sidebar-wrapper">
            <section class="related-posts">
                <h2><i class="fas fa-bookmark"></i> Related Posts</h2>
                <div class="related-posts-grid">
                    <div class="loading">Loading related posts...</div>
                </div>
            </section>
        </div>
    </main>
    <script>
const cloudflareProxy = 'https://neetstudyhub-api-proxy.earnmoney100a.workers.dev';

// Get the postId from the URL
const urlParams = new URLSearchParams(window.location.search);
const postId = urlParams.get('postId');

// Function to fetch and display the post content
async function fetchPost() {
    try {
        // Show loading state
        document.querySelector('.post-title').textContent = 'Loading...';
        document.querySelector('.post-content').innerHTML = '<div class="loading">Loading post content...</div>';

        // Fetch post data via Cloudflare Worker
        const response = await fetch(`${cloudflareProxy}?id=${postId}`);
        const data = await response.json();

        if (!data || !data.title) {
            throw new Error('Post not found');
        }

        // Update document title
        document.title = `${data.title} | NEET Study Hub`;

        // Update breadcrumbs
        document.querySelector('.breadcrumb ul').innerHTML = `
            <li><a href="/"><i class="fas fa-home"></i> Home</a></li>
            <li><a href="/blog.html">All Posts</a></li>
            <li>${data.title}</li>
        `;

        // Update post header
        document.querySelector('.post-title').textContent = data.title;
        document.querySelector('.post-date').innerHTML = `
            <i class="far fa-calendar-alt"></i> ${new Date(data.published).toLocaleDateString()}
        `;
        document.querySelector('.author-name').textContent = 'NEET Study Hub';

        // Update post content
        document.querySelector('.post-content').innerHTML = data.content;

        // Fetch and display related posts
        fetchRelatedPosts();
    } catch (error) {
        console.error('Error fetching the post:', error);
        document.querySelector('.post-content').innerHTML = `
            <div class="error-message">
                <h2>Error Loading Post</h2>
                <p>Sorry, the requested post could not be loaded. Please try again later.</p>
                <a href="/blog.html">Return to Blog</a>
            </div>
        `;
    }
}

// Function to fetch and display related posts
async function fetchRelatedPosts() {
    try {
        const response = await fetch(`${cloudflareProxy}?maxResults=500`);
        const data = await response.json();

        if (data.items && data.items.length > 1) {
            // Shuffle the posts randomly
            const shuffledPosts = data.items.sort(() => 0.5 - Math.random());

            // Select 5 posts (excluding current post and posts with labels "ncert" or "pyq")
            const excludedLabels = ['ncert', 'pyq'];
            const selectedPosts = shuffledPosts
                .filter(post => 
                    post.id !== postId && 
                    (!post.labels || !post.labels.some(label => 
                        excludedLabels.includes(label.toLowerCase())
                    ))
                )
                .slice(0, 5);

            // Render related posts
            const relatedPostsGrid = document.querySelector('.related-posts-grid');
            relatedPostsGrid.innerHTML = selectedPosts.map(post => {
                const imageUrl = extractImageFromContent(post.content);
                return `
                    <article class="related-post">
                        <img src="${imageUrl}" alt="${post.title}">
                        <h3><a href="post.html?postId=${post.id}">${post.title}</a></h3>
                        <p><i class="far fa-clock"></i> ${getReadingTime(post.content)} min read</p>
                    </article>
                `;
            }).join('');
        } else {
            document.querySelector('.related-posts-grid').innerHTML = '<p>No related posts found.</p>';
        }
    } catch (error) {
        console.error('Error fetching related posts:', error);
        document.querySelector('.related-posts-grid').innerHTML = '<p>Error loading related posts.</p>';
    }
}

// Helper function to extract first image from content
function extractImageFromContent(content) {
    const imgTagMatch = content.match(/<img[^>]+src="([^">]+)"/);
    return imgTagMatch ? imgTagMatch[1] : 'https://via.placeholder.com/300x200';
}

// Helper function to calculate reading time
function getReadingTime(content) {
    const wordsPerMinute = 200;
    const tempDiv = document.createElement('div');
    tempDiv.innerHTML = content;
    const text = tempDiv.textContent || tempDiv.innerText;
    const wordCount = text.trim().split(/\s+/).length;
    return Math.ceil(wordCount / wordsPerMinute);
}

// Initialize when document is ready
document.addEventListener('DOMContentLoaded', fetchPost);
      
    </script>
</body>
</html>
